<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æˆ‘çš„å†°ç®± - å°å°ç¾é£Ÿå®¶</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: #f8f9fa;
        }

        .navbar {
            background: white;
            padding: 1rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .nav-tabs {
            display: flex;
            justify-content: space-around;
            list-style: none;
        }

        .nav-tabs li {
            padding: 0.5rem 1rem;
            cursor: pointer;
            border-bottom: 2px solid transparent;
        }

        .nav-tabs li.active {
            border-bottom: 2px solid #e74c3c;
            color: #e74c3c;
        }

        .container {
            padding: 1rem;
        }

        /* é‡æ„å†°ç®±æ·»åŠ é£ŸæåŒºåŸŸæ ·å¼ï¼ˆå’Œé‡‡è´­æ¸…å•æ·»åŠ æ ·å¼ç»Ÿä¸€ï¼‰ */
        .quick-add {
            background: white;
            padding: 1rem;
            border-radius: 12px;
            margin-bottom: 1rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .quick-add-title {
            font-weight: bold;
            color: #333;
            margin-bottom: 1rem;
            font-size: 1rem;
        }

        /* å†°ç®±æ·»åŠ é£Ÿæè¾“å…¥åŒºåŸŸï¼ˆå’Œé‡‡è´­æ¸…å•æ ·å¼ä¸€è‡´ï¼‰ */
        .fridge-add {
            display: flex;
            gap: 0.8rem;
            margin-bottom: 1rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid #eee;
            flex-wrap: wrap;
            align-items: center;
        }

        .fridge-add-input {
            flex: 2;
            min-width: 150px;
            padding: 0.8rem;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 0.9rem;
            height: 46px;
        }

        .fridge-add-quantity {
            flex: 1;
            min-width: 100px;
            padding: 0.8rem;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 0.9rem;
            height: 46px;
        }

        .fridge-add-btn {
            flex: 0 0 50px;
            background: #e74c3c;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            min-width: 80px;
            height: 46px;
        }

        .fridge-add-btn:hover {
            background: #c0392b;
        }

        .view-toggle {
            display: flex;
            background: white;
            border-radius: 12px;
            padding: 0.5rem;
            margin-bottom: 1rem;
            gap: 0.5rem;
        }

        .toggle-btn {
            flex: 1;
            text-align: center;
            padding: 0.8rem;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.2s;
        }

        .toggle-btn.active {
            background: #e74c3c;
            color: white;
        }

        /* è§†å›¾å®¹å™¨æ ·å¼ - é»˜è®¤éšè—ï¼Œç¡®ä¿å¿…é¡»é€‰ä¸­ä¸€ä¸ªè§†å›¾ */
        .view-container {
            display: none;
        }
        /* æ¿€æ´»çš„è§†å›¾æ˜¾ç¤º */
        .view-container.active {
            display: block;
        }

        .category-section {
            background: white;
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 1rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .category-title {
            font-weight: bold;
            margin-bottom: 1rem;
            color: #333;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .ingredients-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 1rem;
        }

        /* åˆ—è¡¨è§†å›¾æ ·å¼ */
        .ingredients-list {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .ingredient-list-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            border-bottom: 1px solid #eee;
            cursor: pointer; /* æ ‡è®°å¯ç‚¹å‡» */
            transition: background 0.2s;
        }

        .ingredient-list-item:hover {
            background: #f9f9f9; /*  hover åé¦ˆ */
        }

        .ingredient-list-item:last-child {
            border-bottom: none;
        }

        .ingredient-list-left {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .ingredient-list-icon {
            width: 40px;
            height: 40px;
            background: #f1f1f1;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }

        .ingredient-list-info {
            display: flex;
            flex-direction: column;
        }

        .ingredient-list-name {
            font-weight: bold;
        }

        .ingredient-list-category {
            font-size: 0.8rem;
            color: #888;
        }

        .ingredient-list-right {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .ingredient-list-quantity {
            color: #666;
        }

        .ingredient-card {
            border: 1px solid #eee;
            border-radius: 8px;
            padding: 1rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .ingredient-card:hover {
            border-color: #e74c3c;
            transform: translateY(-2px);
        }

        .ingredient-name {
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        .ingredient-quantity {
            color: #666;
            font-size: 0.9rem;
        }

        /* é‡‡è´­æ¸…å•æ ·å¼å¢å¼º */
        .shopping-section {
            background: white;
            border-radius: 12px;
            padding: 1rem;
            margin-top: 2rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        /* é‡‡è´­æ¸…å•æ·»åŠ åŒºåŸŸ */
        .shopping-add {
            display: flex;
            gap: 0.8rem;
            margin-bottom: 1rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid #eee;
            flex-wrap: wrap;
            align-items: center;
        }

        .shopping-add-input {
            flex: 2;
            min-width: 150px;
            padding: 0.8rem;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 0.9rem;
            height: 46px;
        }

        .shopping-add-quantity {
            flex: 1;
            min-width: 100px;
            padding: 0.8rem;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 0.9rem;
            height: 46px;
        }

        .shopping-add-btn {
            flex: 0 0 50px;
            background: #e74c3c;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            min-width: 80px;
            height: 46px;
        }

        .shopping-add-btn:hover {
            background: #c0392b;
        }

        .shopping-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.8rem 0;
            border-bottom: 1px solid #eee;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .shopping-item:last-child {
            border-bottom: none;
        }

        /* é‡‡è´­æ¸…å•æ•°é‡æ ·å¼ */
        .shopping-item-left {
            display: flex;
            align-items: center;
            gap: 1rem;
            flex: 1;
            min-width: 150px;
        }

        .shopping-item-name {
            font-weight: 500;
        }

        .shopping-item-quantity {
            font-size: 0.8rem;
            color: #888;
            background: #f1f1f1;
            padding: 0.2rem 0.6rem;
            border-radius: 12px;
        }

        .shopping-item-actions {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .shopping-item button {
            padding: 0.5rem 0.8rem;
            border: 1px solid #e74c3c;
            border-radius: 4px;
            background: white;
            color: #e74c3c;
            cursor: pointer;
            transition: all 0.2s;
            min-width: 80px;
            height: 36px;
        }

        .shopping-item button:hover {
            background: #e74c3c;
            color: white;
        }

        .shopping-item .delete-btn {
            border-color: #95a5a6;
            color: #95a5a6;
        }

        .shopping-item .delete-btn:hover {
            background: #95a5a6;
            color: white;
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .container {
                padding: 0.8rem;
            }

            .quick-add, .shopping-section {
                padding: 0.8rem;
            }

            .fridge-add, .shopping-add {
                flex-direction: column;
            }

            .fridge-add-input, .fridge-add-quantity,
            .shopping-add-input, .shopping-add-quantity {
                width: 100%;
                min-width: auto;
            }

            .fridge-add-btn, .shopping-add-btn {
                width: 100%;
                min-width: auto;
            }

            .shopping-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.8rem;
            }

            .shopping-item-left {
                width: 100%;
                justify-content: space-between;
            }

            .shopping-item-actions {
                width: 100%;
                justify-content: space-between;
            }

            .shopping-item button {
                flex: 1;
            }

            .ingredients-grid {
                grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
                gap: 0.8rem;
            }

            .ingredient-list-item {
                padding: 0.8rem;
            }

            .ingredient-list-left {
                gap: 0.8rem;
            }
        }

        @media (max-width: 480px) {
            .nav-tabs {
                flex-wrap: wrap;
            }

            .nav-tabs li {
                flex: 1;
                text-align: center;
                min-width: 80px;
            }

            .view-toggle {
                flex-direction: row;
            }

            .toggle-btn {
                margin-bottom: 0;
            }

            .ingredients-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
<nav class="navbar">
    <ul class="nav-tabs">
        <li onclick="window.location.href='æˆ‘çš„é£Ÿè°±.html'">æˆ‘çš„é£Ÿè°±</li>
        <li class="active" onclick="window.location.href='æˆ‘çš„å†°ç®±.html'">æˆ‘çš„å†°ç®±</li>
        <li onclick="window.location.href='åƒä»€ä¹ˆ.html'">åƒä»€ä¹ˆ</li>
        <li onclick="window.location.href='æˆ‘çš„.html'">æˆ‘çš„</li>
    </ul>
</nav>

<div class="container">
    <!-- é‡æ„åçš„å†°ç®±æ·»åŠ é£ŸæåŒºåŸŸï¼ˆåˆ é™¤å¿«æ·æ·»åŠ ï¼‰ -->
    <div class="quick-add">
        <div class="quick-add-title">â• æ·»åŠ å†°ç®±é£Ÿæ</div>

        <!-- æ–°çš„æ·»åŠ é£Ÿæè¾“å…¥åŒºåŸŸï¼ˆå’Œé‡‡è´­æ¸…å•æ ·å¼ç»Ÿä¸€ï¼‰ -->
        <div class="fridge-add">
            <input type="text" class="fridge-add-input" id="fridgeIngredientName" placeholder="è¾“å…¥é£Ÿæåç§°ï¼ˆå¦‚ï¼šé»„ç“œï¼‰">
            <input type="text" class="fridge-add-quantity" id="fridgeIngredientQuantity" placeholder="æ•°é‡ï¼ˆå¦‚ï¼š3æ ¹ï¼‰">
            <button class="fridge-add-btn" onclick="addFridgeIngredient()">æ·»åŠ </button>
        </div>
    </div>

    <!-- è§†å›¾åˆ‡æ¢ï¼ˆç¡®ä¿å¿…é¡»é€‰ä¸­ä¸€ä¸ªï¼‰ -->
    <div class="view-toggle">
        <div class="toggle-btn active" onclick="switchView('list')">åˆ—è¡¨è§†å›¾</div>
        <div class="toggle-btn" onclick="switchView('category')">åˆ†ç±»è§†å›¾</div>
    </div>

    <!-- åˆ—è¡¨è§†å›¾å®¹å™¨ï¼ˆé»˜è®¤æ¿€æ´»ï¼‰ -->
    <div id="listView" class="view-container active">
        <div class="ingredients-list" id="fridgeListContainer">
            <div class="ingredient-list-item" onclick="editIngredientByName('ç•ªèŒ„')">
                <div class="ingredient-list-left">
                    <div class="ingredient-list-icon">ğŸ…</div>
                    <div class="ingredient-list-info">
                        <div class="ingredient-list-name">ç•ªèŒ„</div>
                        <div class="ingredient-list-category">è”¬èœæ°´æœ</div>
                    </div>
                </div>
                <div class="ingredient-list-right">
                    <div class="ingredient-list-quantity">2ä¸ª</div>
                </div>
            </div>
            <div class="ingredient-list-item" onclick="editIngredientByName('åœŸè±†')">
                <div class="ingredient-list-left">
                    <div class="ingredient-list-icon">ğŸ¥”</div>
                    <div class="ingredient-list-info">
                        <div class="ingredient-list-name">åœŸè±†</div>
                        <div class="ingredient-list-category">è”¬èœæ°´æœ</div>
                    </div>
                </div>
                <div class="ingredient-list-right">
                    <div class="ingredient-list-quantity">500g</div>
                </div>
            </div>
            <div class="ingredient-list-item" onclick="editIngredientByName('é¸¡è›‹')">
                <div class="ingredient-list-left">
                    <div class="ingredient-list-icon">ğŸ¥š</div>
                    <div class="ingredient-list-info">
                        <div class="ingredient-list-name">é¸¡è›‹</div>
                        <div class="ingredient-list-category">è‚‰ç¦½è›‹å¥¶</div>
                    </div>
                </div>
                <div class="ingredient-list-right">
                    <div class="ingredient-list-quantity">6ä¸ª</div>
                </div>
            </div>
            <div class="ingredient-list-item" onclick="editIngredientByName('é¸¡èƒ¸è‚‰')">
                <div class="ingredient-list-left">
                    <div class="ingredient-list-icon">ğŸ—</div>
                    <div class="ingredient-list-info">
                        <div class="ingredient-list-name">é¸¡èƒ¸è‚‰</div>
                        <div class="ingredient-list-category">è‚‰ç¦½è›‹å¥¶</div>
                    </div>
                </div>
                <div class="ingredient-list-right">
                    <div class="ingredient-list-quantity">300g</div>
                </div>
            </div>
        </div>
    </div>

    <!-- åˆ†ç±»è§†å›¾å®¹å™¨ -->
    <div id="categoryView" class="view-container">
        <div class="category-section">
            <div class="category-title">
                <span>ğŸ¥¦ è”¬èœæ°´æœ</span>
                <span class="count" id="vegetableCount">2ç§</span>
            </div>
            <div class="ingredients-grid" id="vegetableGrid">
                <div class="ingredient-card" onclick="editIngredient(this)">
                    <div class="ingredient-name">ç•ªèŒ„</div>
                    <div class="ingredient-quantity">2ä¸ª</div>
                </div>
                <div class="ingredient-card" onclick="editIngredient(this)">
                    <div class="ingredient-name">åœŸè±†</div>
                    <div class="ingredient-quantity">500g</div>
                </div>
            </div>
        </div>

        <div class="category-section">
            <div class="category-title">
                <span>ğŸ¥© è‚‰ç¦½è›‹å¥¶</span>
                <span class="count" id="meatCount">2ç§</span>
            </div>
            <div class="ingredients-grid" id="meatGrid">
                <div class="ingredient-card" onclick="editIngredient(this)">
                    <div class="ingredient-name">é¸¡è›‹</div>
                    <div class="ingredient-quantity">6ä¸ª</div>
                </div>
                <div class="ingredient-card" onclick="editIngredient(this)">
                    <div class="ingredient-name">é¸¡èƒ¸è‚‰</div>
                    <div class="ingredient-quantity">300g</div>
                </div>
            </div>
        </div>
    </div>

    <!-- é‡‡è´­æ¸…å• -->
    <div class="shopping-section">
        <div class="category-title">
            <span>ğŸ›’ é‡‡è´­æ¸…å•</span>
        </div>

        <div class="shopping-add">
            <input type="text" class="shopping-add-input" id="shoppingName" placeholder="è¾“å…¥é£Ÿæåç§°ï¼ˆå¦‚ï¼šå°è‘±ï¼‰">
            <input type="text" class="shopping-add-quantity" id="shoppingQuantity" placeholder="æ•°é‡ï¼ˆå¦‚ï¼š200gï¼‰">
            <button class="shopping-add-btn" onclick="addShoppingItem()">æ·»åŠ </button>
        </div>

        <div id="shoppingList">
            <div class="shopping-item">
                <div class="shopping-item-left">
                    <span class="shopping-item-name">å°è‘±</span>
                    <span class="shopping-item-quantity">200g</span>
                </div>
                <div class="shopping-item-actions">
                    <button onclick="addToFridge('å°è‘±', '200g')">åŠ å…¥å†°ç®±</button>
                    <button class="delete-btn" onclick="deleteShoppingItem(this)">åˆ é™¤</button>
                </div>
            </div>
            <div class="shopping-item">
                <div class="shopping-item-left">
                    <span class="shopping-item-name">ç”Ÿå§œ</span>
                    <span class="shopping-item-quantity">100g</span>
                </div>
                <div class="shopping-item-actions">
                    <button onclick="addToFridge('ç”Ÿå§œ', '100g')">åŠ å…¥å†°ç®±</button>
                    <button class="delete-btn" onclick="deleteShoppingItem(this)">åˆ é™¤</button>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // åˆå§‹åŒ–è§†å›¾ - å¼ºåˆ¶é»˜è®¤åˆ—è¡¨è§†å›¾ï¼Œç¡®ä¿å¿…é¡»é€‰ä¸­ä¸€ä¸ª
    document.addEventListener('DOMContentLoaded', function() {
        // å¼ºåˆ¶æ¿€æ´»åˆ—è¡¨è§†å›¾æŒ‰é’®å’Œå®¹å™¨
        document.querySelector('.toggle-btn').classList.add('active');
        document.getElementById('listView').classList.add('active');
    });

    // åˆ‡æ¢è§†å›¾åŠŸèƒ½ï¼ˆç¡®ä¿å¿…é¡»é€‰ä¸­ä¸€ä¸ªï¼Œä¸”åªèƒ½é€‰ä¸€ä¸ªï¼‰
    function switchView(view) {
        // ç§»é™¤æ‰€æœ‰æŒ‰é’®çš„æ¿€æ´»çŠ¶æ€
        document.querySelectorAll('.toggle-btn').forEach(btn => {
            btn.classList.remove('active');
        });
        // æ¿€æ´»å½“å‰ç‚¹å‡»çš„æŒ‰é’®
        event.target.classList.add('active');

        // éšè—æ‰€æœ‰è§†å›¾å®¹å™¨
        document.querySelectorAll('.view-container').forEach(container => {
            container.classList.remove('active');
        });

        // æ˜¾ç¤ºé€‰ä¸­çš„è§†å›¾å®¹å™¨ï¼ˆç¡®ä¿å¿…æœ‰ä¸€ä¸ªè§†å›¾æ˜¾ç¤ºï¼‰
        const targetView = document.getElementById(view + 'View');
        if (targetView) {
            targetView.classList.add('active');
        } else {
            // å…œåº•ï¼šå¦‚æœç›®æ ‡è§†å›¾ä¸å­˜åœ¨ï¼Œé»˜è®¤æ˜¾ç¤ºåˆ—è¡¨è§†å›¾
            document.getElementById('listView').classList.add('active');
            document.querySelector('.toggle-btn').classList.add('active');
        }
    }

    // ========== å†°ç®±é£Ÿææ·»åŠ æ ¸å¿ƒåŠŸèƒ½ ==========
    // æ‰‹åŠ¨æ·»åŠ å†°ç®±é£Ÿæï¼ˆå¸¦æ•°é‡ï¼‰
    function addFridgeIngredient() {
        // è·å–è¾“å…¥å€¼
        const nameInput = document.getElementById('fridgeIngredientName');
        const quantityInput = document.getElementById('fridgeIngredientQuantity');
        const name = nameInput.value.trim();
        const quantity = quantityInput.value.trim();

        // è¾“å…¥éªŒè¯
        if (!name) {
            alert('è¯·è¾“å…¥é£Ÿæåç§°ï¼');
            nameInput.focus();
            return;
        }
        if (!quantity) {
            alert('è¯·è¾“å…¥é£Ÿææ•°é‡ï¼');
            quantityInput.focus();
            return;
        }

        // è‡ªåŠ¨åˆ†ç±»ï¼ˆç®€å•ç‰ˆï¼Œå¯æ‰©å±•æ›´å¤šåˆ†ç±»ï¼‰
        const vegetableKeywords = ['ç•ªèŒ„', 'åœŸè±†', 'é»„ç“œ', 'é’èœ', 'è¾£æ¤’', 'èƒ¡èåœ', 'è¥¿å…°èŠ±'];
        const meatKeywords = ['é¸¡è›‹', 'é¸¡è‚‰', 'ç‰›è‚‰', 'çŒªè‚‰', 'é¸¡èƒ¸è‚‰', 'é±¼è‚‰'];
        let category = 'å…¶ä»–é£Ÿæ';
        let icon = 'ğŸ±';

        if (vegetableKeywords.includes(name)) {
            category = 'è”¬èœæ°´æœ';
            icon = 'ğŸ¥¦';
        } else if (meatKeywords.includes(name)) {
            category = 'è‚‰ç¦½è›‹å¥¶';
            icon = 'ğŸ¥©';
        }

        // æ·»åŠ åˆ°åˆ—è¡¨è§†å›¾
        addToListView(name, quantity, category, icon);

        // æ·»åŠ åˆ°åˆ†ç±»è§†å›¾
        addToCategoryView(name, quantity, category);

        // æ¸…ç©ºè¾“å…¥æ¡†
        nameInput.value = '';
        quantityInput.value = '';
        nameInput.focus();

        alert(`å·²æ·»åŠ  ${name}(${quantity}) åˆ°å†°ç®±`);
    }

    // æ·»åŠ åˆ°åˆ—è¡¨è§†å›¾
    function addToListView(name, quantity, category, icon) {
        const container = document.getElementById('fridgeListContainer');

        // æ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨è¯¥é£Ÿæ
        const existingItems = container.querySelectorAll('.ingredient-list-name');
        for (let item of existingItems) {
            if (item.textContent === name) {
                alert(`${name} å·²åœ¨å†°ç®±ä¸­ï¼Œå¯ç‚¹å‡»ç¼–è¾‘æ•°é‡`);
                return;
            }
        }

        // åˆ›å»ºæ–°åˆ—è¡¨é¡¹
        const newItem = document.createElement('div');
        newItem.className = 'ingredient-list-item';
        newItem.onclick = () => editIngredientByName(name);
        newItem.innerHTML = `
            <div class="ingredient-list-left">
                <div class="ingredient-list-icon">${icon}</div>
                <div class="ingredient-list-info">
                    <div class="ingredient-list-name">${name}</div>
                    <div class="ingredient-list-category">${category}</div>
                </div>
            </div>
            <div class="ingredient-list-right">
                <div class="ingredient-list-quantity">${quantity}</div>
            </div>
        `;

        container.appendChild(newItem);
    }

    // æ·»åŠ åˆ°åˆ†ç±»è§†å›¾
    function addToCategoryView(name, quantity, category) {
        let gridId = 'otherGrid';
        let countId = 'otherCount';

        if (category === 'è”¬èœæ°´æœ') {
            gridId = 'vegetableGrid';
            countId = 'vegetableCount';
        } else if (category === 'è‚‰ç¦½è›‹å¥¶') {
            gridId = 'meatGrid';
            countId = 'meatCount';
        }

        const grid = document.getElementById(gridId);
        if (!grid) return; // é˜²æ­¢å…¶ä»–åˆ†ç±»æš‚æ— å®¹å™¨

        // æ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨
        const existingItems = grid.querySelectorAll('.ingredient-name');
        for (let item of existingItems) {
            if (item.textContent === name) {
                return;
            }
        }

        // åˆ›å»ºæ–°å¡ç‰‡
        const newCard = document.createElement('div');
        newCard.className = 'ingredient-card';
        newCard.onclick = function() { editIngredient(this); };
        newCard.innerHTML = `
            <div class="ingredient-name">${name}</div>
            <div class="ingredient-quantity">${quantity}</div>
        `;

        grid.appendChild(newCard);

        // æ›´æ–°åˆ†ç±»è®¡æ•°
        updateCategoryCount(countId);
    }

    // æ›´æ–°åˆ†ç±»è®¡æ•°
    function updateCategoryCount(countId) {
        const countElement = document.getElementById(countId);
        if (countElement) {
            const currentCount = parseInt(countElement.textContent);
            countElement.textContent = `${currentCount + 1}ç§`;
        }
    }

    // ========== åŸæœ‰ç¼–è¾‘åŠŸèƒ½ ==========
    function editIngredient(element) {
        const name = element.querySelector('.ingredient-name').textContent;
        const quantity = element.querySelector('.ingredient-quantity').textContent;
        const newQuantity = prompt(`ä¿®æ”¹ ${name} çš„æ•°é‡:`, quantity);
        if (newQuantity !== null && newQuantity.trim() !== '') {
            element.querySelector('.ingredient-quantity').textContent = newQuantity;
            updateListIngredientQuantity(name, newQuantity);
        }
    }

    function editIngredientByName(name) {
        const categoryItems = document.querySelectorAll('#categoryView .ingredient-name');
        let quantity = '';

        categoryItems.forEach(item => {
            if (item.textContent === name) {
                quantity = item.nextElementSibling.textContent;
            }
        });

        const newQuantity = prompt(`ä¿®æ”¹ ${name} çš„æ•°é‡:`, quantity);
        if (newQuantity !== null && newQuantity.trim() !== '') {
            updateListIngredientQuantity(name, newQuantity);
            updateCategoryIngredientQuantity(name, newQuantity);
        }
    }

    function updateListIngredientQuantity(name, newQuantity) {
        const listItems = document.querySelectorAll('#listView .ingredient-list-item');
        listItems.forEach(item => {
            const itemName = item.querySelector('.ingredient-list-name').textContent;
            if (itemName === name) {
                item.querySelector('.ingredient-list-quantity').textContent = newQuantity;
            }
        });
    }

    function updateCategoryIngredientQuantity(name, newQuantity) {
        const categoryItems = document.querySelectorAll('#categoryView .ingredient-name');
        categoryItems.forEach(item => {
            if (item.textContent === name) {
                item.nextElementSibling.textContent = newQuantity;
            }
        });
    }

    // ========== é‡‡è´­æ¸…å•åŠŸèƒ½ ==========
    function addShoppingItem() {
        const nameInput = document.getElementById('shoppingName');
        const quantityInput = document.getElementById('shoppingQuantity');
        const name = nameInput.value.trim();
        const quantity = quantityInput.value.trim();

        if (!name) {
            alert('è¯·è¾“å…¥é£Ÿæåç§°ï¼');
            nameInput.focus();
            return;
        }
        if (!quantity) {
            alert('è¯·è¾“å…¥é£Ÿææ•°é‡ï¼');
            quantityInput.focus();
            return;
        }

        const shoppingList = document.getElementById('shoppingList');
        const newItem = document.createElement('div');
        newItem.className = 'shopping-item';
        newItem.innerHTML = `
            <div class="shopping-item-left">
                <span class="shopping-item-name">${name}</span>
                <span class="shopping-item-quantity">${quantity}</span>
            </div>
            <div class="shopping-item-actions">
                <button onclick="addToFridge('${name}', '${quantity}')">åŠ å…¥å†°ç®±</button>
                <button class="delete-btn" onclick="deleteShoppingItem(this)">åˆ é™¤</button>
            </div>
        `;

        shoppingList.appendChild(newItem);
        nameInput.value = '';
        quantityInput.value = '';
        nameInput.focus();
    }

    function deleteShoppingItem(btn) {
        const item = btn.closest('.shopping-item');
        const name = item.querySelector('.shopping-item-name').textContent;
        if (confirm(`ç¡®å®šè¦åˆ é™¤é‡‡è´­é¡¹ã€Œ${name}ã€å—ï¼Ÿ`)) {
            item.remove();
        }
    }

    function addToFridge(ingredient, quantity) {
        // è‡ªåŠ¨åˆ†ç±»
        const vegetableKeywords = ['ç•ªèŒ„', 'åœŸè±†', 'é»„ç“œ', 'å°è‘±', 'ç”Ÿå§œ', 'é’èœ', 'è¾£æ¤’'];
        const meatKeywords = ['é¸¡è›‹', 'é¸¡è‚‰', 'ç‰›è‚‰', 'çŒªè‚‰', 'é¸¡èƒ¸è‚‰'];
        let category = 'å…¶ä»–é£Ÿæ';
        let icon = 'ğŸ±';

        if (vegetableKeywords.includes(ingredient)) {
            category = 'è”¬èœæ°´æœ';
            icon = 'ğŸ¥¦';
        } else if (meatKeywords.includes(ingredient)) {
            category = 'è‚‰ç¦½è›‹å¥¶';
            icon = 'ğŸ¥©';
        }

        // æ·»åŠ åˆ°å†°ç®±
        addToListView(ingredient, quantity, category, icon);
        addToCategoryView(ingredient, quantity, category);

        // ç§»é™¤é‡‡è´­é¡¹
        event.target.closest('.shopping-item').remove();
        alert(`å·²å°† ${ingredient}(${quantity}) åŠ å…¥å†°ç®±`);
    }
</script>
</body>
</html>