# 智能食谱管理系统 - 测试文档

## 1. 用户认证模块

### 1.1 用户注册
- **功能**: 新用户注册账号
- **测试点**:
  - 输入用户名、手机号、密码、确认密码
  - 验证手机号格式（11位数字）
  - 验证密码一致性
  - 验证手机号唯一性（不能重复注册）
  - 注册成功后自动创建用户冰箱
- **预期结果**: 注册成功，返回用户信息

### 1.2 用户登录
- **功能**: 已注册用户登录系统
- **测试点**:
  - 支持手机号或用户ID登录
  - 密码验证
  - 登录成功返回JWT token
  - Token存储在localStorage
  - 登录失败提示错误信息
- **预期结果**: 登录成功，跳转到主页

### 1.3 游客模式
- **功能**: 无需注册即可浏览系统
- **测试点**:
  - 使用guest-token访问
  - 可浏览食谱广场
  - 可查看推荐食谱
  - 部分功能受限（如收藏、创建食谱）
- **预期结果**: 游客可以浏览但不能修改数据

### 1.4 个人资料
- **功能**: 查看和修改个人信息
- **测试点**:
  - 查看当前用户名、手机号
  - 修改昵称
  - 修改用户名
  - 需要登录认证
- **预期结果**: 修改成功并更新显示

---

## 2. 食谱管理模块

### 2.1 食谱广场（Recipe Square）
- **功能**: 浏览系统预设食谱
- **测试点**:
  - 显示所有系统食谱（user_id为null）
  - 分类筛选（早餐、午餐、晚餐、汤、甜点等）
  - 难度筛选（简单、中等、困难）
  - 烹饪时间筛选
  - 搜索功能（按食谱名称）
  - 随机推荐12个食谱
  - 收藏/取消收藏系统食谱
  - 添加/移除系统食谱到个人收藏
  - 分页加载
- **预期结果**: 正确显示和筛选系统食谱

### 2.2 我的食谱（My Recipes）
- **功能**: 管理用户创建的食谱
- **测试点**:
  - 创建新食谱（名称、分类、难度、时间、食材、步骤、提示）
  - 查看个人创建的食谱列表
  - 按最新、最常做、收藏排序
  - 收藏/取消收藏个人食谱
  - 记录烹饪次数
  - 删除个人食谱
  - 食谱详情页显示完整信息
- **预期结果**: 可以完整管理个人食谱

### 2.3 我的收藏（My Favorites）
- **功能**: 查看所有收藏的食谱
- **测试点**:
  - 显示收藏的系统食谱（通过user_recipes表）
  - 显示收藏的个人食谱（通过recipes表的is_favorite字段）
  - 从"我的"页面点击"我的收藏"跳转
  - URL参数：`/?sort=favorite`
  - 取消收藏后自动从列表移除
- **预期结果**: 正确显示所有收藏的食谱

### 2.4 食谱详情
- **功能**: 查看食谱完整信息
- **测试点**:
  - 显示食谱名称、分类、难度、时间
  - 显示食材列表（名称、数量）
  - 显示烹饪步骤
  - 显示烹饪提示
  - 显示营养信息
  - 显示烹饪次数
  - 收藏/取消收藏按钮
  - 记录烹饪按钮（增加cooked_count）
  - 系统食谱显示"Fork"按钮（复制到个人食谱）
- **预期结果**: 完整显示食谱信息并支持交互

### 2.5 Fork食谱
- **功能**: 将系统食谱复制为个人食谱
- **测试点**:
  - 复制所有食谱信息
  - 设置user_id为当前用户
  - 可以修改复制后的食谱
  - 不影响原系统食谱
- **预期结果**: 成功创建个人副本

---

## 3. 推荐系统模块

### 3.1 "吃什么"推荐
- **功能**: 基于冰箱食材智能推荐食谱
- **测试点**:
  - 根据冰箱食材匹配食谱
  - 显示匹配度（可做食材数/总食材数）
  - 推荐模式：
    - `all`: 所有食谱
    - `can_make`: 可以完全制作的食谱
    - `partial`: 部分食材匹配的食谱
  - 范围选择：
    - `all`: 系统+个人食谱
    - `system`: 仅系统食谱
    - `mine`: 仅个人食谱
  - 排序方式：
    - `match`: 按匹配度排序
    - `time`: 按烹饪时间排序
    - `difficulty`: 按难度排序
  - 收藏功能（星标按钮）
  - 点击卡片查看详情
- **预期结果**: 智能推荐符合条件的食谱

---

## 4. 冰箱管理模块

### 4.1 查看冰箱
- **功能**: 查看冰箱内所有食材
- **测试点**:
  - 显示食材名称、数量、单位
  - 按分类分组显示（蔬菜、肉类、调料等）
  - 显示添加时间
  - 空冰箱提示
- **预期结果**: 正确显示冰箱食材

### 4.2 添加食材
- **功能**: 向冰箱添加新食材
- **测试点**:
  - 输入食材名称（必填）
  - 输入数量
  - 选择分类
  - 选择单位
  - 自动记录添加时间
- **预期结果**: 成功添加食材到冰箱

### 4.3 删除食材
- **功能**: 从冰箱移除食材
- **测试点**:
  - 点击删除按钮
  - 确认删除操作
  - 立即从列表移除
- **预期结果**: 成功删除食材

### 4.4 冰箱初始化
- **功能**: 用户注册时自动创建冰箱
- **测试点**:
  - 每个用户有且仅有一个冰箱
  - user_id唯一约束
  - 级联删除（删除用户时删除冰箱）
- **预期结果**: 自动创建用户冰箱

---

## 5. 采购清单模块（已移除UI入口）

### 5.1 查看采购清单
- **功能**: 查看待购买食材列表
- **测试点**:
  - 显示所有待购买项目
  - 显示名称、数量、分类
  - 按分类分组
- **预期结果**: 正确显示采购清单

### 5.2 添加采购项
- **功能**: 添加新的待购买食材
- **测试点**:
  - 输入食材名称
  - 输入数量
  - 选择分类
  - 自动记录创建时间
- **预期结果**: 成功添加采购项

### 5.3 移至冰箱
- **功能**: 将采购项移动到冰箱
- **测试点**:
  - 点击"移至冰箱"按钮
  - 在冰箱中创建对应食材
  - 从采购清单删除该项
  - 保留数量和分类信息
- **预期结果**: 成功转移到冰箱

### 5.4 删除采购项
- **功能**: 删除采购清单项目
- **测试点**:
  - 点击删除按钮
  - 立即从列表移除
- **预期结果**: 成功删除采购项

---

## 6. 导航和UI模块

### 6.1 底部导航栏
- **功能**: 主要页面导航
- **测试点**:
  - "我的食谱"按钮 → Recipes页面
  - "我的冰箱"按钮 → Fridge页面
  - "食谱广场"按钮 → RecipeSquare页面
  - "吃什么"按钮 → Recommendation页面
  - "我的"按钮 → Mine页面
  - 当前页面高亮显示
  - 图标和文字正确显示
- **预期结果**: 导航正确切换页面

### 6.2 "我的"页面
- **功能**: 个人中心和快捷入口
- **测试点**:
  - 显示用户头像和昵称
  - 显示统计数据（食谱数量、烹饪次数、收藏数量）
  - "我的收藏"按钮 → 跳转到 `/?sort=favorite`
  - "我的食谱"按钮 → 跳转到 `/?mine=true`
  - "采购清单"入口已移除
  - 退出登录按钮
- **预期结果**: 正确显示信息和导航

### 6.3 路由守卫
- **功能**: 页面访问权限控制
- **测试点**:
  - 未登录访问受保护页面 → 重定向到登录页
  - 已登录访问登录/注册页 → 重定向到主页
  - Token验证失败 → 清除token并跳转登录
  - 游客token特殊处理
- **预期结果**: 正确控制页面访问权限

---

## 7. 数据交互模块

### 7.1 收藏功能区分
- **功能**: 正确处理系统食谱和个人食谱的收藏
- **测试点**:
  - **系统食谱**（user_id为null）:
    - 收藏状态存储在`user_recipes`表
    - 调用 `POST /api/user-recipes/favorite`
    - `is_favorite`字段切换
  - **个人食谱**（有user_id）:
    - 收藏状态存储在`recipes`表
    - 调用 `POST /api/recipes/:id/favorite`
    - `is_favorite`字段切换
  - UI实时更新（星标/心形图标）
  - 在以下页面测试：
    - Recommendation.vue（吃什么页面）
    - Recipes.vue（我的食谱页面）
    - RecipeSquare.vue（食谱广场）
    - RecipeDetail.vue（食谱详情）
- **预期结果**: 收藏功能在所有页面正确工作

### 7.2 查询参数处理
- **功能**: Recipes页面响应URL参数
- **测试点**:
  - `?sort=favorite` → 显示收藏的食谱
  - `?sort=latest` → 按最新排序
  - `?sort=most_cooked` → 按烹饪次数排序
  - `?mine=true` → 仅显示个人创建的食谱
  - 参数变化时自动重新加载数据
  - 无效参数时使用默认值
- **预期结果**: 正确响应查询参数

---

## 8. 错误处理和边界情况

### 8.1 网络错误
- **测试点**:
  - 后端服务未启动
  - 网络超时
  - 401未授权 → 自动跳转登录
  - 500服务器错误 → 显示错误提示
- **预期结果**: 友好的错误提示

### 8.2 数据验证
- **测试点**:
  - 空表单提交
  - 无效的手机号格式
  - 密码不一致
  - 重复的手机号注册
  - 超长字符串输入
- **预期结果**: 前端和后端都进行验证

### 8.3 空数据状态
- **测试点**:
  - 空冰箱提示
  - 无食谱时的占位提示
  - 无推荐结果时的提示
  - 空采购清单提示
- **预期结果**: 显示友好的空状态提示

---

## 9. 性能测试

### 9.1 数据加载
- **测试点**:
  - 大量食谱时的加载速度
  - 分页加载性能
  - 图片懒加载
  - 列表滚动流畅度
- **预期结果**: 页面响应流畅

### 9.2 数据库查询
- **测试点**:
  - 索引使用情况
  - 复杂查询性能（推荐算法）
  - 关联查询优化
- **预期结果**: 查询响应时间<500ms

---

## 10. 兼容性测试

### 10.1 浏览器兼容
- **测试点**:
  - Chrome（主要）
  - Firefox
  - Safari
  - Edge
- **预期结果**: 主流浏览器正常运行

### 10.2 响应式设计
- **测试点**:
  - 移动端布局
  - 平板布局
  - 桌面端布局
  - 触摸操作支持
- **预期结果**: 适配不同屏幕尺寸

---

## 测试账号

### 演示用户
- **手机号**: 13800138000
- **密码**: 123456
- **用户ID**: 1
- **用途**: 完整功能测试

### 游客模式
- **Token**: guest-token
- **用途**: 浏览功能测试
